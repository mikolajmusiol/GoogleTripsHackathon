<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Simple Google Gemini Chatbot</title>
    <style>
        body {font-family: Arial, sans-serif; margin: 0; padding: 0; display:flex; flex-direction: column; height: 100vh;}
        #messages {flex: 1; overflow-y: auto; padding: 1rem; background: #f5f5f5;}
        .msg {margin-bottom: .75rem;}
        .msg.user {text-align: right;}
        .msg.bot {text-align: left;}
        .bubble {display: inline-block; padding: .5rem .75rem; border-radius: 1rem; max-width: 60%;}
        .user .bubble {background: #007bff; color: #fff;}
        .bot .bubble {background: #e4e4e4; color: #000;}
        #input-bar {display: flex; border-top: 1px solid #ddd;}
        #input {flex: 1; padding: 1rem; border: none; outline: none; font-size: 1rem;}
        #send {padding: 0 1rem; border: none; background: #007bff; color: #fff; cursor: pointer; font-size: 1rem;}
    </style>
</head>
<body>
    <div id="messages"></div>
    <div id="input-bar">
        <input id="input" type="text" placeholder="Type a message" />
        <button id="send">Send</button>
    </div>

    <script>
        const messages = document.getElementById("messages");
        const input = document.getElementById("input");
        const sendBtn = document.getElementById("send");

        function appendMessage(text, sender) {
            const wrapper = document.createElement("div");
            wrapper.className = `msg ${sender}`;
            const bubble = document.createElement("div");
            bubble.className = "bubble";
            bubble.textContent = text;
            wrapper.appendChild(bubble);
            messages.appendChild(wrapper);
            messages.scrollTop = messages.scrollHeight;
        }

        async function send() {
            const text = input.value.trim();
            if (!text) return;
            appendMessage(text, "user");
            input.value = "";
            try {
                const res = await fetch("/chat", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ message: text }),
                });
                const data = await res.json();
                if (res.ok) {
                    appendMessage(data.response, "bot");
                } else {
                    appendMessage(`Error: ${data.error || res.statusText}`, "bot");
                }
            } catch (err) {
                appendMessage(`Network error: ${err.message}`, "bot");
            }
        }

        sendBtn.addEventListener("click", send);
        input.addEventListener("keydown", (e) => {
            if (e.key === "Enter") send();
        });
    </script>
</body>
</html>
